import Web3 from "web3";
import { AbiItem } from "web3-utils";

import type { IPFSStorage } from "../IPFSStorage.js";
import { BaseContract } from "../types.js";

export interface IPFSStorageFactory {
  deploy(options?: any): Promise<IPFSStorage>;
}

const _abi = [
  {
    inputs: [],
    name: "getCID",
    outputs: [
      {
        internalType: "string",
        name: "",
        type: "string",
      },
    ],
    stateMutability: "view",
    type: "function",
  },
  {
    inputs: [
      {
        internalType: "string",
        name: "cid",
        type: "string",
      },
    ],
    name: "storeCID",
    outputs: [],
    stateMutability: "nonpayable",
    type: "function",
  },
] as AbiItem[];

const _bytecode =
  "0x608060405234801561001057600080fd5b5061039f806100206000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c806302790e341461003b578063ccfdd32b14610059575b600080fd5b61004361006e565b6040516100509190610173565b60405180910390f35b61006c6100673660046101c1565b610161565b005b6060600080805461007e90610233565b9050116100d15760405162461bcd60e51b815260206004820152600b60248201527f434944206e6f7420736574000000000000000000000000000000000000000000604482015260640160405180910390fd5b600080546100de90610233565b80601f016020809104026020016040519081016040528092919081815260200182805461010a90610233565b80156101575780601f1061012c57610100808354040283529160200191610157565b820191906000526020600020905b81548152906001019060200180831161013a57829003601f168201915b5050505050905090565b600061016e8284836102d1565b505050565b600060208083528351808285015260005b818110156101a057858101830151858201604001528201610184565b506000604082860101526040601f19601f8301168501019250505092915050565b600080602083850312156101d457600080fd5b823567ffffffffffffffff808211156101ec57600080fd5b818501915085601f83011261020057600080fd5b81358181111561020f57600080fd5b86602082850101111561022157600080fd5b60209290920196919550909350505050565b600181811c9082168061024757607f821691505b60208210810361026757634e487b7160e01b600052602260045260246000fd5b50919050565b634e487b7160e01b600052604160045260246000fd5b601f82111561016e57600081815260208120601f850160051c810160208610156102aa5750805b601f850160051c820191505b818110156102c9578281556001016102b6565b505050505050565b67ffffffffffffffff8311156102e9576102e961026d565b6102fd836102f78354610233565b83610283565b6000601f84116001811461033157600085156103195750838201355b600019600387901b1c1916600186901b17835561038b565b600083815260209020601f19861690835b828110156103625786850135825560209485019460019092019101610342565b508682101561037f5760001960f88860031b161c19848701351681555b505060018560011b0183555b505050505056fea164736f6c6343000811000a";

export class IPFSStorage__factory implements IPFSStorageFactory {
  async deploy(web3: Web3, options?: any): Promise<IPFSStorage> {
    return (await new web3.eth.Contract(_abi).deploy({ data: _bytecode }).send(options)) as BaseContract as IPFSStorage;
  }
}
